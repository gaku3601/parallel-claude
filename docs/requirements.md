# Parallel Claude - 要件定義書

## プロジェクト概要

macOSの"conductor"と同様に、Claude Code CLIを複数のgit worktreeで並列に動作させるWindows専用デスクトップアプリケーション。

## 目的

- 複数のブランチで同時にClaude Codeを使った開発を可能にする
- git worktreeの管理を簡単にする
- Claude Codeのターミナルインターフェースを統合的に提供する

## ターゲット環境

- **OS**: Windows 10/11
- **必須ソフトウェア**:
  - Git (git worktree機能を使用)
  - Claude Code CLI (`claude`コマンド)
  - Node.js (Electronアプリ実行用)

## MVP機能要件

### 1. サイドパネル - プロジェクト管理

#### 1.1 プロジェクト一覧表示
- 登録されたGitリポジトリプロジェクトを一覧表示
- プロジェクト名とパスを表示
- プロジェクトの追加/削除が可能

#### 1.2 Worktree一覧表示
- 各プロジェクト配下に、そのプロジェクトのgit worktreeを一覧表示
- worktree名（ブランチ名）を表示
- アクティブなworktreeを視覚的に識別可能

#### 1.3 Worktree作成
- プロジェクト配下の「プラスボタン」をクリック
- ランダムだが意味のある名前（世界の都市名など）でブランチとgit worktreeを自動生成
- 生成されたworktreeをサイドパネルに即座に表示

**命名規則例**:
- `tokyo-20250107-1423` (都市名-日付-時刻)
- `paris-fix-auth`
- `london-feature-user`

#### 1.4 Worktree削除
- 各worktree項目にごみ箱アイコンを表示
- クリックで確認ダイアログなしで即座にgit worktreeを削除
- 削除後、サイドパネルから項目を削除

### 2. メインパネル - ターミナル統合

#### 2.1 Claude Code ターミナル表示
- worktreeをクリックすると、メインパネルにターミナルを表示
- ターミナルは自動的に以下を実行:
  1. 該当worktreeのディレクトリに`cd`
  2. `claude`コマンドを実行してインタラクティブセッションを開始

#### 2.2 複数ターミナルのタブ管理
- 複数のworktreeを同時に開ける
- タブUIで切り替え可能
- アクティブなタブを視覚的に識別

#### 2.3 ターミナル基本機能
- 標準的なターミナル操作（入力、出力、スクロール）
- コピー＆ペースト対応
- ターミナルのリサイズ対応

### 3. ファイル添付機能

#### 3.1 Ctrl+Vでの画像添付
- ターミナルにフォーカスがある状態でCtrl+Vを押下
- クリップボードに画像がある場合:
  1. 一時ファイルとして保存
  2. Claude Codeに画像を送信
- クリップボードにテキストがある場合:
  - 通常のペースト動作

#### 3.2 対応ファイル形式
- 画像: PNG, JPEG, GIF, WebP
- 将来的にはPDFやその他のファイルにも対応

## 非機能要件

### パフォーマンス
- アプリケーション起動時間: 3秒以内
- worktree作成時間: 5秒以内（git操作時間を除く）
- ターミナル入力レスポンス: 100ms以内

### ユーザビリティ
- 直感的なUI/UX（conductorを参考）
- キーボードショートカット対応
- エラーメッセージは具体的で分かりやすく

### 信頼性
- git操作失敗時の適切なエラーハンドリング
- アプリケーションクラッシュ時の状態復元
- データの永続化（プロジェクト設定、開いているworktreeなど）

## データ永続化

### 保存するデータ
- 登録済みプロジェクト一覧（パス、名前）
- 最後に開いていたworktree/タブの状態
- アプリケーション設定（ウィンドウサイズ、位置など）

### 保存場所
- Windows: `%APPDATA%/parallel-claude/config.json`

## UI/UXデザイン指針

### レイアウト
```
+------------------+----------------------------------+
|  Side Panel      |  Main Panel                     |
|  (250px)         |  (Flexible)                     |
|                  |                                  |
|  + Project A     |  [Tab: tokyo-20250107]          |
|    - tokyo-xxx   |  +----------------------------+  |
|    - paris-xxx   |  | Terminal: claude session   |  |
|    [+]           |  |                            |  |
|                  |  | > claude                   |  |
|  + Project B     |  | Connected to Claude Code   |  |
|    - london-xxx  |  | ...                        |  |
|    [🗑️]          |  +----------------------------+  |
|    [+]           |                                  |
+------------------+----------------------------------+
```

### カラースキーム
- ダークテーマを基本とする
- アクセントカラー: ブルー系
- ターミナル: 一般的なターミナルカラースキーム

### アイコン
- プラスボタン: `+` または `⊕`
- ごみ箱: `🗑️` またはアイコンライブラリを使用
- プロジェクト: `📁`
- Worktree: `🌿` または `📂`

## 技術スタック

- **フレームワーク**: Electron
- **UI**: React + TypeScript
- **ビルドツール**: Vite
- **ターミナルエミュレーション**: node-pty + xterm.js
- **スタイリング**: CSS Modules / Tailwind CSS (検討)
- **状態管理**: React Context / Zustand (検討)

## 制約事項

1. Claude Code CLIがインストールされていることが前提
2. Gitがインストールされていることが前提
3. git worktreeの制限に従う（同じブランチを複数worktreeで開けない等）
4. Windows専用（macOS/Linuxはサポート外）

## 将来的な拡張機能（MVP外）

- worktreeの名前変更機能
- プロジェクトテンプレート（初期セットアップスクリプト実行など）
- Claude Codeのレスポンスを履歴として保存
- ドラッグ&ドロップでのファイル添付
- 複数ファイルの同時添付
- カスタムテーマ設定
- ターミナルのフォント/サイズ設定
- git操作のGUIサポート（コミット、プッシュなど）
- AIとの会話履歴の検索機能
